<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Slides from Firebase</title>
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --transition: 0.3s ease;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
    }

    img {
      max-width: 100%;
      height: auto;
    }

    .container {
      width: 90%;
      margin: auto;
    }

    nav {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
    }

    h1, h2, h3, p {
      word-wrap: break-word;
    }

    /* Slider/Carousel */
    .slider-container {
      position: relative;
      height: 35vh;
      overflow: hidden;
      border-radius: 0 0 20px 20px;
      box-shadow: var(--shadow);
    }

    .slider {
      display: flex;
      height: 100%;
      transition: transform 0.5s ease-in-out;
    }

    .slide {
      min-width: 100%;
      height: 100%;
      background-size: cover;
      background-position: center;
      position: relative;
    }

    .slider-nav {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
    }

    .slider-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.5);
      cursor: pointer;
      transition: var(--transition);
    }

    .slider-dot.active {
      background: white;
      transform: scale(1.2);
    }

    .slider-btn {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.3);
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 1rem;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .slider-btn:hover,
    .slider-btn:focus {
      background: rgba(255, 255, 255, 0.5);
    }

    .prev {
      left: 10px;
    }

    .next {
      right: 10px;
    }

    /* Responsive adjustments */
    @media (max-width: 600px) {
      .slider-btn {
        width: 36px;
        height: 36px;
        font-size: 0.9rem;
      }

      .slider-dot {
        width: 8px;
        height: 8px;
      }
    }

    /* Loading spinner */
    .loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100%;
      color: white;
      background: #333;
    }

    .spinner {
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-top: 4px solid white;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      animation: spin 1s linear infinite;
      margin-bottom: 10px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Error state */
    .error {
      background: #e53e3e;
      color: white;
      padding: 15px;
      text-align: center;
    }
  </style>
</head>
<body>
  <div class="slider-container">
    <div class="slider" id="slider">
      <div class="loading">
        <div class="spinner"></div>
        <p>Loading slides from Firebase...</p>
      </div>
    </div>
    <button class="slider-btn prev" id="prevBtn"><i class="fas fa-chevron-left"></i></button>
    <button class="slider-btn next" id="nextBtn"><i class="fas fa-chevron-right"></i></button>
    <div class="slider-nav" id="sliderNav"></div>
  </div>

  <!-- Firebase SDK -->
  <script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "firebase/app";
    import { getAnalytics } from "firebase/analytics";

    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCPbOZwAZEMiC1LSDSgnSEPmSxQ7-pR2oQ",
      authDomain: "mirdhuna-25542.firebaseapp.com",
      databaseURL: "https://mirdhuna-25542-default-rtdb.firebaseio.com",
      projectId: "mirdhuna-25542",
      storageBucket: "mirdhuna-25542.firebasestorage.app",
      messagingSenderId: "575924409876",
      appId: "1:575924409876:web:6ba1ed88ce941d9c83b901",
      measurementId: "G-YB7LDKHBPV"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);

    // Slider variables
    let currentSlide = 0;
    let slides = [];
    let sliderInterval;
    const SLIDE_DURATION = 5000; // 5 seconds

    // DOM elements
    const slider = document.getElementById('slider');
    const sliderNav = document.getElementById('sliderNav');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');

    // Initialize slider - IMAGE ONLY (no text/content)
    function initSlider() {
      // Clear previous content
      slider.innerHTML = '';
      sliderNav.innerHTML = '';
      
      if (slides.length === 0) {
        slider.innerHTML = '<div class="error">No slides available</div>';
        return;
      }

      // Create slides (image only)
      slides.forEach(slide => {
        const slideEl = document.createElement('div');
        slideEl.className = 'slide';
        slideEl.style.backgroundImage = `url(${slide.image})`;
        // No text, no content â€” just the image as background
        slider.appendChild(slideEl);
      });

      // Create navigation dots
      slides.forEach((_, index) => {
        const dot = document.createElement('div');
        dot.className = `slider-dot ${index === 0 ? 'active' : ''}`;
        dot.addEventListener('click', () => goToSlide(index));
        sliderNav.appendChild(dot);
      });

      // Show first slide
      updateSlider();
    }

    // Update slider position and active dot
    function updateSlider() {
      slider.style.transform = `translateX(-${currentSlide * 100}%)`;
      
      // Update active dot
      document.querySelectorAll('.slider-dot').forEach((dot, index) => {
        dot.classList.toggle('active', index === currentSlide);
      });
    }

    // Navigation functions
    function goToSlide(index) {
      currentSlide = index;
      updateSlider();
      resetAutoSlide();
    }

    function showNextSlide() {
      currentSlide = (currentSlide + 1) % slides.length;
      updateSlider();
      resetAutoSlide();
    }

    function showPrevSlide() {
      currentSlide = (currentSlide - 1 + slides.length) % slides.length;
      updateSlider();
      resetAutoSlide();
    }

    // Auto-slide functionality
    function startAutoSlide() {
      sliderInterval = setInterval(showNextSlide, SLIDE_DURATION);
    }

    function resetAutoSlide() {
      clearInterval(sliderInterval);
      startAutoSlide();
    }

    // Touch swipe support
    let startX = 0;
    slider.addEventListener('touchstart', (e) => {
      startX = e.changedTouches[0].screenX;
    });

    slider.addEventListener('touchend', (e) => {
      const endX = e.changedTouches[0].screenX;
      const diff = startX - endX;
      
      if (Math.abs(diff) > 50) {
        if (diff > 0) showNextSlide();
        else showPrevSlide();
      }
    });

    // Button event listeners
    prevBtn.addEventListener('click', showPrevSlide);
    nextBtn.addEventListener('click', showNextSlide);

    // Font size adjustment (optional, kept as per original)
    function adjustFontSize() {
      const width = window.innerWidth;
      document.body.style.fontSize = width < 600 ? "16px" : "18px";
    }

    window.addEventListener("resize", adjustFontSize);
    window.addEventListener("load", adjustFontSize);

    // Fetch data from Firebase Realtime Database
    function fetchSlides() {
      // Load Firebase Realtime Database compat SDK
      import('https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js')
        .then(() => {
          const { getDatabase, ref, onValue } = firebase.database;

          const db = getDatabase();
          const slidesRef = ref(db, 'slides');
          
          onValue(slidesRef, (snapshot) => {
            const data = snapshot.val();
            
            if (data) {
              slides = Object.keys(data).map(key => ({
                id: key,
                ...data[key]
              })).sort((a, b) => (a.order || 0) - (b.order || 0));
              
              initSlider();
              startAutoSlide();
            } else {
              slider.innerHTML = '<div class="error">No slides found in database</div>';
            }
          }, (error) => {
            console.error("Firebase error:", error);
            slider.innerHTML = `<div class="error">Error loading slides: ${error.message}</div>`;
          });
        })
        .catch(err => {
          console.error("Failed to load Firebase Database SDK:", err);
          slider.innerHTML = `<div class="error">SDK load error: ${err.message}</div>`;
        });
    }

    // Start fetching slides
    fetchSlides();
  </script>
</body>
</html>
