<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MIRDHUNA - Exquisite Flavors</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-red: #d32f2f;
            --primary-yellow: #ffab00;
            --primary-blue: #1565c0;
            --accent-gold: #ffd600;
            --light-bg: #fff8e1;
            --dark-text: #212121;
            --off-white: #f5f5f5;
            --shadow: 0 8px 16px rgba(0,0,0,0.2);
            --transition: all 0.3s ease;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #fce4ec, #e3f2fd, #fff8e1);
            background-size: 400% 400%;
            animation: gradientBG 20s ease infinite;
            color: var(--dark-text);
            padding-bottom: 180px; /* Space for non-fixed footer */
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        h1, h2, h3, .logo {
            font-family: 'Playfair Display', serif;
        }

        /* Header & Navigation */
        header {
            background: linear-gradient(to right, var(--primary-red), var(--primary-blue));
            color: white;
            padding: 15px 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .logo-container {
            display: flex;
            align-items: center;
        }

        .logo {
            font-size: 2.2rem;
            font-weight: 900;
            letter-spacing: 1px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .logo-icon {
            margin-right: 10px;
            color: var(--accent-gold);
            font-size: 2rem;
        }

        nav a {
            margin-left: 25px;
            text-decoration: none;
            color: white;
            font-weight: 500;
            padding: 8px 12px;
            border-radius: 20px;
            transition: var(--transition);
            display: flex;
            align-items: center;
        }

        nav a i {
            margin-right: 5px;
        }

        nav a:hover {
            background-color: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .header-icons {
            display: flex;
            align-items: center;
        }

        .cart-icon, .user-icon, .view-cart-icon {
            position: relative;
            cursor: pointer;
            font-size: 1.6rem;
            margin-left: 20px;
            transition: var(--transition);
            color: white;
        }

        .cart-icon:hover, .user-icon:hover, .view-cart-icon:hover {
            color: var(--accent-gold);
            transform: scale(1.1);
        }

        .cart-count {
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--accent-gold);
            color: var(--dark-text);
            border-radius: 50%;
            width: 22px;
            height: 22px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 0.75rem;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }

        /* Hero Slider Section */
        .hero-slider {
            width: 100%;
            height: 40vh;
            max-height: 500px;
            overflow: hidden;
            margin-top: 10px;
            border-radius: 0 0 20px 20px;
            box-shadow: var(--shadow);
            position: relative;
        }

        .hero-slides {
            display: flex;
            width: 500%;
            height: 100%;
        }

        .hero-slide {
            min-width: 20%;
            height: 100%;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .slide-overlay {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
            padding: 20px;
        }

        .slide-title {
            font-size: 2rem;
            margin-bottom: 10px;
            text-shadow: 1px 1px 3px black;
        }

        .slide-text {
            font-size: 1.1rem;
            max-width: 80%;
            text-shadow: 1px 1px 2px black;
        }

        /* Menu Section */
        .menu-section {
            padding: 30px 5%;
            margin-top: 30px;
        }

        .section-title {
            text-align: center;
            margin-bottom: 30px;
            color: var(--primary-red);
            font-size: 2.5rem;
            position: relative;
        }

        .section-title::after {
            content: '';
            display: block;
            width: 100px;
            height: 4px;
            background: linear-gradient(to right, var(--primary-red), var(--primary-yellow));
            margin: 10px auto;
            border-radius: 2px;
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
        }

        .menu-item {
            background-color: var(--off-white);
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .menu-item:hover {
            transform: translateY(-10px);
            box-shadow: 0 12px 20px rgba(0,0,0,0.25);
        }

        .menu-img-container {
            height: 200px;
            overflow: hidden;
        }

        .menu-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .menu-item:hover .menu-img {
            transform: scale(1.05);
        }

        .menu-details {
            padding: 20px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
        }

        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .menu-name {
            font-weight: 700;
            font-size: 1.4rem;
            color: var(--dark-text);
        }

        .menu-price {
            background: linear-gradient(to right, var(--primary-red), var(--primary-blue));
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .menu-description {
            color: #555;
            margin-bottom: 20px;
            flex-grow: 1;
        }

        .add-to-cart {
            background: linear-gradient(to right, var(--primary-blue), var(--primary-red));
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 500;
            font-size: 1rem;
            transition: var(--transition);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .add-to-cart:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.25);
        }

        .add-to-cart i {
            margin-right: 8px;
        }

        /* Reviews Section */
        .reviews-section {
            padding: 30px 5%;
            margin-top: 40px;
            background-color: rgba(255, 255, 255, 0.7);
            border-radius: 15px;
            box-shadow: var(--shadow);
        }

        .reviews-grid {
             display: grid;
             grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
             gap: 25px;
             margin-top: 20px;
        }

        .review-card {
            background: var(--light-bg);
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .review-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }

        .reviewer-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary-blue);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            margin-right: 15px;
            flex-shrink: 0;
        }

        .reviewer-info h4 {
            margin: 0;
            color: var(--dark-text);
        }

        .review-date {
            font-size: 0.8rem;
            color: #777;
        }

        .review-stars {
            color: var(--accent-gold);
            margin: 10px 0;
        }

        .review-text {
            font-style: italic;
            color: #444;
        }

        /* Cart Modal */
        #cartModal {
             display: none;
             position: fixed;
             z-index: 1002;
             left: 0;
             top: 0;
             width: 100%;
             height: 100%;
             overflow: auto;
             background-color: rgba(0,0,0,0.6);
             backdrop-filter: blur(3px);
        }

        #cartModal .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 0;
            border: 1px solid #888;
            border-radius: 10px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 4px 8px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);
            animation-name: animatetop;
            animation-duration: 0.4s
        }

        @keyframes animatetop {
            from {top: -300px; opacity: 0}
            to {top: 0; opacity: 1}
        }

        #cartModal .modal-header {
            padding: 15px 20px;
            background-color: var(--primary-blue);
            color: white;
            border-radius: 10px 10px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #cartModal .modal-header h2 {
             margin: 0;
             font-family: 'Playfair Display', serif;
        }

        #cartModal .close {
            color: white;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            transition: var(--transition);
        }

        #cartModal .close:hover,
        #cartModal .close:focus {
            color: var(--accent-gold);
        }

        #cartModal .modal-body {
            padding: 20px;
            overflow-y: auto;
            flex-grow: 1;
        }

        #cartItems {
             width: 100%;
             border-collapse: collapse;
        }

        #cartItems th, #cartItems td {
             border-bottom: 1px solid #ddd;
             padding: 12px;
             text-align: left;
        }

        #cartItems th {
             background-color: #f2f2f2;
        }

        .cart-item-quantity {
             display: flex;
             align-items: center;
        }

        .cart-item-quantity button {
             background-color: var(--primary-blue);
             color: white;
             border: none;
             padding: 5px 10px;
             cursor: pointer;
             border-radius: 3px;
        }

        .cart-item-quantity input {
             width: 40px;
             text-align: center;
             margin: 0 5px;
             border: 1px solid #ccc;
             border-radius: 3px;
        }

        #cartModal .modal-footer {
            padding: 15px 20px;
            background-color: #f9f9f9;
            border-radius: 0 0 10px 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        #cartTotal {
             font-size: 1.2rem;
             font-weight: bold;
        }

        #checkoutBtn {
             background-color: var(--primary-red);
             color: white;
             border: none;
             padding: 10px 20px;
             cursor: pointer;
             border-radius: 5px;
             font-weight: bold;
             transition: var(--transition);
        }

        #checkoutBtn:hover {
             background-color: #b71c1c;
        }

        #checkoutBtn:disabled {
             background-color: #cccccc;
             cursor: not-allowed;
        }

        /* Modals */
        .modal {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.7);
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: linear-gradient(135deg, var(--light-bg), #e3f2fd);
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.4);
            position: relative;
            animation: modalPop 0.4s ease-out forwards;
        }

        @keyframes modalPop {
            0% { opacity: 0; transform: translateY(-50px) scale(0.9); }
            100% { opacity: 1; transform: translateY(0) scale(1); }
        }

        .close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 2rem;
            cursor: pointer;
            color: var(--dark-text);
            transition: var(--transition);
        }

        .close:hover {
            color: var(--primary-red);
            transform: rotate(90deg);
        }

        .modal-content h2 {
            text-align: center;
            margin-bottom: 25px;
            color: var(--primary-blue);
            font-size: 2rem;
        }

        #loginForm input, #locationInput {
            width: 100%;
            padding: 15px;
            margin: 15px 0;
            border: 2px solid #ccc;
            border-radius: 10px;
            font-size: 1rem;
            transition: var(--transition);
        }

        #loginForm input:focus, #locationInput:focus {
            border-color: var(--primary-blue);
            outline: none;
            box-shadow: 0 0 0 2px rgba(21, 101, 192, 0.2);
        }

        #loginForm button, #getLocationBtn {
            background: linear-gradient(to right, var(--primary-red), var(--primary-blue));
            color: white;
            padding: 15px 25px;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            width: 100%;
            font-weight: 500;
            font-size: 1.1rem;
            margin-top: 10px;
            transition: var(--transition);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        #loginForm button:hover, #getLocationBtn:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        #getLocationBtn {
            background: linear-gradient(to right, #4caf50, #2e7d32);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        #getLocationBtn i {
            margin-right: 10px;
        }

        #locationStatus {
            text-align: center;
            margin-top: 10px;
            font-size: 0.9rem;
            min-height: 1.2rem;
            color: #555;
        }

        /* Footer */
        footer {
            width: 100%;
            background: #1a1a1a;
            color: white;
            padding: 20px 5%;
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: flex-start;
            box-shadow: 0 -4px 15px rgba(0,0,0,0.3);
            z-index: 99;
            font-family: 'Playfair Display', serif;
            margin-top: 40px;
        }

        .footer-section {
            flex: 1;
            min-width: 200px;
            margin: 15px;
        }

        .footer-section h3 {
            color: var(--accent-gold);
            margin-bottom: 15px;
            font-size: 1.3rem;
            border-bottom: 1px solid var(--primary-blue);
            padding-bottom: 8px;
            display: inline-block;
        }

        .footer-section p, .footer-section a {
            color: #ddd;
            text-decoration: none;
            display: block;
            margin: 8px 0;
            transition: color 0.3s ease;
        }

        .footer-section a:hover {
            color: var(--accent-gold);
        }

        .social-links {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
        }

        .social-links a {
            margin: 0 15px 15px 0;
            color: white;
            font-size: 1.8rem;
            transition: var(--transition);
        }

        .social-links a:hover {
            color: var(--accent-gold);
            transform: translateY(-3px) scale(1.2);
        }

        .contact-info {
            font-size: 1.1rem;
            display: flex;
            flex-direction: column;
        }

        .contact-info i {
            margin-right: 10px;
            color: var(--accent-gold);
        }

        .contact-line {
             display: flex;
             align-items: center;
             margin: 8px 0;
        }

        .tagline {
            font-style: italic;
            text-align: center;
            width: 100%;
            padding: 15px;
            background-color: rgba(0, 0, 0, 0.2);
            font-size: 1rem;
            border-top: 1px solid #444;
            margin-top: 10px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .hero-slider { height: 30vh; }
            .slide-title { font-size: 1.5rem; }
            .slide-text { font-size: 0.9rem; max-width: 95%;}
            .menu-grid { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
            nav a { margin-left: 10px; font-size: 0.9rem; padding: 6px 10px; }
            .logo { font-size: 1.8rem; }
            .cart-icon, .user-icon, .view-cart-icon { font-size: 1.4rem; margin-left: 15px; }
            footer { flex-direction: column; align-items: center; padding: 20px 3%; text-align: center; }
            .footer-section { min-width: 100%; margin: 15px 0; }
            .social-links { justify-content: center; }
            .tagline { font-size: 0.9rem; }
            .menu-header { flex-direction: column; align-items: flex-start; }
            .menu-price { margin-top: 10px; }
        }

        @media (max-width: 480px) {
            header { padding: 12px 3%; flex-direction: column; gap: 10px; }
            .logo-container { justify-content: center; }
            nav { width: 100%; justify-content: center; flex-wrap: wrap; }
            nav a { margin: 5px 8px; font-size: 0.8rem; padding: 5px 8px; }
            .hero-slider { height: 25vh; }
            .section-title { font-size: 2rem; }
            .menu-grid { grid-template-columns: 1fr; }
            .reviews-grid { grid-template-columns: 1fr; }
            .modal-content { padding: 20px; }
            .menu-details { padding: 15px; }
            .add-to-cart { padding: 10px 15px; font-size: 0.9rem; }
            .review-header { flex-direction: column; align-items: flex-start; text-align: center; }
            .reviewer-avatar { margin-bottom: 10px; }
        }

    </style>
</head>
<body>

    <header>
        <div class="logo-container">
            <i class="fas fa-utensils logo-icon"></i>
            <div class="logo">MIRDHUNA</div>
        </div>
        <nav>
            <a href="#" id="mapLink"><i class="fas fa-map-marked-alt"></i> Find Us</a>
            <a href="#" id="reviewsLink"><i class="fas fa-star"></i> Reviews</a>
        </nav>
        <div class="header-icons">
             <div class="view-cart-icon" id="openCart">
                <i class="fas fa-shopping-basket"></i>
                <span class="cart-count" id="cartCountHeader">0</span>
            </div>
            <div class="user-icon" id="openLogin">
                <i class="fas fa-user"></i>
            </div>
        </div>
    </header>

    <!-- Hero Slider Section -->
    <div class="hero-slider">
        <div class="hero-slides">
            <div class="hero-slide" style="background-image: url('https://images.unsplash.com/photo-1513104890138-7c749659a591?q=80&w=1000');">
                <div class="slide-overlay">
                    <h2 class="slide-title">Authentic Flavors</h2>
                    <p class="slide-text">Experience the true taste of tradition in every bite.</p>
                </div>
            </div>
            <div class="hero-slide" style="background-image: url('https://images.unsplash.com/photo-1414235077428-338989a2e8c0?q=80&w=1000');">
                <div class="slide-overlay">
                    <h2 class="slide-title">Fresh Ingredients</h2>
                    <p class="slide-text">Sourced daily for the highest quality and taste.</p>
                </div>
            </div>
            <div class="hero-slide" style="background-image: url('https://images.unsplash.com/photo-1555939594-58d7cb561ad1?q=80&w=1000');">
                <div class="slide-overlay">
                    <h2 class="slide-title">Delicious Deals</h2>
                    <p class="slide-text">Enjoy great food without breaking the bank.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Menu Section (acts as Homepage) -->
    <section class="menu-section">
        <h2 class="section-title">Our Delectable Menu</h2>
        <div class="menu-grid" id="menuGrid">
            <!-- Menu items will be populated dynamically -->
        </div>
    </section>

    <!-- Reviews Section -->
    <section class="reviews-section" id="reviewsSection">
        <h2 class="section-title">Customer Reviews</h2>
        <div class="reviews-grid" id="reviewsGrid">
            <div class="review-card">
                <div class="review-header">
                    <div class="reviewer-avatar">JD</div>
                    <div class="reviewer-info">
                        <h4>John Doe</h4>
                        <div class="review-date">2023-11-15</div>
                    </div>
                </div>
                <div class="review-stars">
                    <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star-half-alt"></i>
                </div>
                <p class="review-text">"The Biriyani was absolutely incredible! The flavors were so rich and authentic. Will definitely order again!"</p>
            </div>
             <div class="review-card">
                <div class="review-header">
                    <div class="reviewer-avatar">AS</div>
                    <div class="reviewer-info">
                        <h4>Anita Singh</h4>
                        <div class="review-date">2023-12-02</div>
                    </div>
                </div>
                <div class="review-stars">
                    <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i>
                </div>
                <p class="review-text">"Fast delivery and the food was still hot and fresh. The customer service was also very polite. Highly recommended!"</p>
            </div>
             <div class="review-card">
                <div class="review-header">
                    <div class="reviewer-avatar">MR</div>
                    <div class="reviewer-info">
                        <h4>Mike Rahman</h4>
                        <div class="review-date">2024-01-10</div>
                    </div>
                </div>
                <div class="review-stars">
                    <i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="fas fa-star"></i><i class="far fa-star"></i>
                </div>
                <p class="review-text">"Great variety on the menu. The Tandoori Platter was a hit at our party. The presentation was also very nice."</p>
            </div>
        </div>
    </section>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeLogin">&times;</span>
            <h2>Welcome to MIRDHUNA</h2>
            <form id="loginForm">
                <input type="tel" id="mobileNumber" placeholder="Enter Mobile Number" required>
                <label for="locationInput">Your Location (Coordinates):</label>
                <input type="text" id="locationInput" placeholder="Click 'Get My Location' to fetch coordinates" readonly>
                <button type="button" id="getLocationBtn"><i class="fas fa-location-arrow"></i> Get My Location</button>
                <div id="locationStatus">Please click the button to get your location coordinates.</div>
                <button type="submit">Login & Proceed</button>
            </form>
        </div>
    </div>

    <!-- Cart Modal -->
    <div id="cartModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Your Cart</h2>
                <span class="close" id="closeCart">&times;</span>
            </div>
            <div class="modal-body">
                <table id="cartItems">
                    <thead>
                        <tr>
                            <th>Item</th>
                            <th>Price</th>
                            <th>Quantity</th>
                            <th>Total</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Cart items will be populated here -->
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <span id="cartTotal">Total: ₹0.00</span>
                <button id="checkoutBtn">Proceed to Checkout</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-section">
            <h3>Find Us</h3>
            <p><i class="fas fa-map-marker-alt"></i> 123 Flavor Street, Foodie City</p>
            <p><i class="fas fa-clock"></i> Open: 11:00 AM - 10:00 PM</p>
            <p><i class="fas fa-motorcycle"></i> Delivery Available</p>
        </div>
        <div class="footer-section">
            <h3>Connect</h3>
            <div class="social-links">
                <a href="https://www.facebook.com" target="_blank" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                <a href="https://wa.me/9835124772" target="_blank" aria-label="WhatsApp"><i class="fab fa-whatsapp"></i></a>
                <a href="https://www.instagram.com" target="_blank" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
                <a href="https://t.me/yourusername" target="_blank" aria-label="Telegram"><i class="fab fa-telegram-plane"></i></a>
            </div>
        </div>
        <div class="footer-section">
            <h3>Contact</h3>
            <div class="contact-info">
                <div class="contact-line"><i class="fas fa-phone-alt"></i> +91 98351 24772</div>
                <div class="contact-line"><i class="fas fa-envelope"></i> info@mirdhuna.com</div>
            </div>
        </div>
        <div class="tagline">Crafting Memories, One Meal at a Time.</div>
    </footer>

    <!-- ==================== FIREBASE INTEGRATION ==================== -->
    <!-- Firebase App (core) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <!-- Firebase Realtime Database -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
    <!-- Firebase Authentication (for sign-in state) -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <!-- (Optional) Firebase Analytics -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-analytics-compat.js"></script>

    <script>
        // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyCPbOZwAZEMiC1LSDSgnSEPmSxQ7-pR2oQ",
          authDomain: "mirdhuna-25542.firebaseapp.com",
          databaseURL: "https://mirdhuna-25542-default-rtdb.firebaseio.com",
          projectId: "mirdhuna-25542",
          storageBucket: "mirdhuna-25542.firebasestorage.app",
          messagingSenderId: "575924409876",
          appId: "1:575924409876:web:6ba1ed88ce941d9c83b901",
          measurementId: "G-YB7LDKHBPV"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const auth = firebase.auth(); // Initialize Authentication

        console.log("Firebase initialized successfully.");

        // --- Global Variables ---
        const locationInput = document.getElementById('locationInput');
        const locationStatus = document.getElementById('locationStatus');
        const getLocationBtn = document.getElementById('getLocationBtn');
        let currentCart = []; // Cart is now managed in memory, not localStorage
        let currentUser = null; // To hold the Firebase user object

        // --- Firebase Auth State Listener ---
        auth.onAuthStateChanged(user => {
            if (user) {
                currentUser = user;
                console.log("User is signed in:", user.uid);
                // Optionally, load user-specific data (like cart) from Firebase here if needed
                // For now, we'll keep the cart in memory per session.
            } else {
                currentUser = null;
                console.log("No user is signed in.");
                // Clear cart if user logs out
                currentCart = [];
                updateCartCount();
            }
        });

        // --- Basic Interactions ---

        // Slider Functionality
        let heroSlideIndex = 0;
        const heroSlides = document.querySelector('.hero-slides');
        const totalHeroSlides = document.querySelectorAll('.hero-slide').length;

        function showHeroSlides() {
            heroSlideIndex = (heroSlideIndex + 1) % totalHeroSlides;
            heroSlides.style.transform = `translateX(${-heroSlideIndex * 20}%)`;
        }
        setInterval(showHeroSlides, 5000);

        // Modal Controls - Login
        const loginModal = document.getElementById("loginModal");
        const openLoginBtn = document.getElementById("openLogin");
        const closeLoginSpan = document.getElementById("closeLogin");

        openLoginBtn.onclick = function() {
            loginModal.style.display = "flex";
        }
        closeLoginSpan.onclick = function() {
            loginModal.style.display = "none";
        }

        // Modal Controls - Cart
        const cartModal = document.getElementById("cartModal");
        const openCartBtn = document.getElementById("openCart");
        const closeCartSpan = document.getElementById("closeCart");

        openCartBtn.onclick = function() {
            displayCart();
            cartModal.style.display = "block";
        }
        closeCartSpan.onclick = function() {
            cartModal.style.display = "none";
        }
        window.onclick = function(event) {
            if (event.target == loginModal) {
                loginModal.style.display = "none";
            }
            if (event.target == cartModal) {
                cartModal.style.display = "none";
            }
        }

        // Update cart count
        function updateCartCount() {
            const count = currentCart.reduce((total, item) => total + item.quantity, 0);
            document.getElementById('cartCountHeader').innerText = count;
        }
        updateCartCount(); // Initial update

        document.getElementById('mapLink').addEventListener('click', function(e) {
             e.preventDefault();
             alert('Opening Google Maps to our location...');
        });

        document.getElementById('reviewsLink').addEventListener('click', function(e) {
             e.preventDefault();
             document.getElementById('reviewsSection').scrollIntoView({ behavior: 'smooth' });
        });

        // --- Location Logic (Coordinates Only) ---
        function getLocationCoordinates() {
            if (navigator.geolocation) {
                locationStatus.textContent = "Locating...";
                getLocationBtn.disabled = true;
                navigator.geolocation.getCurrentPosition(
                    showCoordinates,
                    showError,
                    { enableHighAccuracy: true, timeout: 10000, maximumAge: 300000 }
                );
            } else {
                locationStatus.textContent = "Geolocation is not supported by this browser.";
                getLocationBtn.disabled = false;
            }
        }

        function showCoordinates(position) {
            const lat = position.coords.latitude.toFixed(6);
            const lng = position.coords.longitude.toFixed(6);
            locationInput.value = `Lat: ${lat}, Lng: ${lng}`;
            locationStatus.textContent = "Coordinates fetched successfully!";
            locationStatus.style.color = "green";
            getLocationBtn.disabled = false;
        }

        function showError(error) {
            switch(error.code) {
                case error.PERMISSION_DENIED:
                    locationStatus.textContent = "Location access denied. Please allow location access.";
                    break;
                case error.POSITION_UNAVAILABLE:
                    locationStatus.textContent = "Location information is unavailable.";
                    break;
                case error.TIMEOUT:
                    locationStatus.textContent = "The request to get user location timed out.";
                    break;
                case error.UNKNOWN_ERROR:
                    locationStatus.textContent = "An unknown error occurred.";
                    break;
            }
            locationStatus.style.color = "red";
            getLocationBtn.disabled = false;
        }

        getLocationBtn.addEventListener('click', getLocationCoordinates);

        // --- Login Form Submission (Simplified) ---
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const mobile = document.getElementById('mobileNumber').value.trim();
            const location = locationInput.value.trim();

            if (!mobile) {
                alert("Please enter your mobile number.");
                return;
            }
            if (!location || location.includes("Click 'Get My Location'") || location === "") {
                alert("Please get your location coordinates first.");
                return;
            }

            // --- Sign in Anonymously to get a UID ---
            // This ensures we have a user context for database rules.
            auth.signInAnonymously()
                .then((userCredential) => {
                    // Signed in..
                    const user = userCredential.user;
                    console.log("Anonymous user signed in:", user.uid);

                    // --- Save user data to Firebase using the anonymous UID ---
                    const userRef = firebase.database().ref('users/' + user.uid); // Use Firebase UID
                    const userData = {
                        mobile: mobile,
                        location: location,
                        lastLogin: firebase.database.ServerValue.TIMESTAMP
                    };

                    return userRef.set(userData); // Return the promise for chaining
                })
                .then(() => {
                    console.log("User data saved to Firebase successfully using UID.");
                    alert(`Successfully logged in!\nMobile: ${mobile}\nLocation (Coords): ${location}`);
                    loginModal.style.display = "none";
                    document.getElementById('loginForm').reset();
                    locationInput.placeholder = "Click 'Get My Location' to fetch coordinates";
                    locationStatus.textContent = "Please click the button to get your location coordinates.";
                    locationStatus.style.color = "initial";
                })
                .catch((error) => {
                    const errorCode = error.code;
                    const errorMessage = error.message;
                    console.error("Error during login/sign-in:", errorCode, errorMessage);
                    alert("Login failed. Please try again. Error: " + errorMessage);
                    loginModal.style.display = "none"; // Close modal on error
                });
        });

        // --- Menu Items & Cart Logic ---
        function loadMenuItemsFromFirebase() {
            const menuGrid = document.getElementById('menuGrid');
            menuGrid.innerHTML = '<p style="text-align:center; grid-column: 1 / -1;">Loading menu...</p>';

            const menuRef = firebase.database().ref('menu');
            menuRef.once('value')
                .then((snapshot) => {
                    menuGrid.innerHTML = '';
                    const menuData = snapshot.val();

                    if (!menuData) {
                        menuGrid.innerHTML = '<p style="text-align:center; grid-column: 1 / -1; color: orange;">Menu is currently unavailable. Admin needs to add items.</p>';
                        return;
                    }

                    Object.keys(menuData).forEach(key => {
                        const item = menuData[key];
                        const menuItemElement = document.createElement('div');
                        menuItemElement.className = 'menu-item';
                        menuItemElement.innerHTML = `
                            <div class="menu-img-container">
                                <img src="${item.image || 'https://via.placeholder.com/300x200?text=No+Image'}" alt="${item.name}" class="menu-img" loading="lazy" onerror="this.onerror=null; this.src='https://via.placeholder.com/300x200?text=Image+Error';">
                            </div>
                            <div class="menu-details">
                                <div class="menu-header">
                                    <h3 class="menu-name">${item.name || 'Unknown Item'}</h3>
                                    <div class="menu-price">₹${item.price !== undefined ? item.price : '?'} </div>
                                </div>
                                <p class="menu-description">${item.description || 'No description available.'}</p>
                                <button class="add-to-cart" data-id="${key}" data-name="${item.name || 'Item'}" data-price="${item.price !== undefined ? item.price : 0}">
                                    <i class="fas fa-cart-plus"></i> Add to Cart
                                </button>
                            </div>
                        `;
                        menuGrid.appendChild(menuItemElement);
                    });

                    document.querySelectorAll('.add-to-cart').forEach(button => {
                        button.addEventListener('click', function() {
                            if (!currentUser) {
                                alert("Please log in first.");
                                loginModal.style.display = "flex";
                                return;
                            }

                            const itemId = this.getAttribute('data-id');
                            const itemName = this.getAttribute('data-name');
                            const itemPrice = parseFloat(this.getAttribute('data-price'));

                            // Manage cart in memory
                            const existingItemIndex = currentCart.findIndex(cartItem => cartItem.id === itemId);

                            if (existingItemIndex > -1) {
                                currentCart[existingItemIndex].quantity += 1;
                            } else {
                                currentCart.push({ id: itemId, name: itemName, price: itemPrice, quantity: 1 });
                            }

                            updateCartCount();
                            alert(`"${itemName}" added to cart!`);
                            console.log("Cart updated in memory:", currentCart);
                        });
                    });

                })
                .catch((error) => {
                    console.error("Error loading menu from Firebase:", error);
                    menuGrid.innerHTML = '<p style="text-align:center; color:red; grid-column: 1 / -1;">Failed to load menu. Please check your connection or database setup.</p>';
                });
        }

        // --- Cart Display & Management (in memory) ---
        function displayCart() {
             const cartItemsTable = document.querySelector('#cartItems tbody');
             const cartTotalElement = document.getElementById('cartTotal');
             cartItemsTable.innerHTML = '';

             let total = 0;
             if (currentCart.length === 0) {
                 cartItemsTable.innerHTML = '<tr><td colspan="5" style="text-align:center;">Your cart is empty.</td></tr>';
                 cartTotalElement.textContent = 'Total: ₹0.00';
                 return;
             }

             currentCart.forEach((item, index) => {
                 const itemTotal = item.price * item.quantity;
                 total += itemTotal;
                 const row = document.createElement('tr');
                 row.innerHTML = `
                     <td>${item.name}</td>
                     <td>₹${item.price.toFixed(2)}</td>
                     <td class="cart-item-quantity">
                         <button class="decrease-qty" data-index="${index}">-</button>
                         <input type="number" class="qty-input" data-index="${index}" value="${item.quantity}" min="1">
                         <button class="increase-qty" data-index="${index}">+</button>
                     </td>
                     <td>₹${itemTotal.toFixed(2)}</td>
                     <td><button class="remove-item" data-index="${index}"><i class="fas fa-trash"></i></button></td>
                 `;
                 cartItemsTable.appendChild(row);
             });

             cartTotalElement.textContent = `Total: ₹${total.toFixed(2)}`;

             document.querySelectorAll('.decrease-qty').forEach(button => {
                 button.addEventListener('click', function() {
                     const index = parseInt(this.getAttribute('data-index'));
                     if (currentCart[index].quantity > 1) {
                         currentCart[index].quantity--;
                         updateCartCount();
                         displayCart(); // Re-render
                     }
                 });
             });

             document.querySelectorAll('.increase-qty').forEach(button => {
                 button.addEventListener('click', function() {
                     const index = parseInt(this.getAttribute('data-index'));
                     currentCart[index].quantity++;
                     updateCartCount();
                     displayCart(); // Re-render
                 });
             });

             document.querySelectorAll('.qty-input').forEach(input => {
                 input.addEventListener('change', function() {
                     const index = parseInt(this.getAttribute('data-index'));
                     const newQty = parseInt(this.value);
                     if (!isNaN(newQty) && newQty > 0) {
                         currentCart[index].quantity = newQty;
                         updateCartCount();
                         displayCart(); // Re-render
                     } else {
                         this.value = currentCart[index].quantity; // Revert if invalid
                     }
                 });
             });

             document.querySelectorAll('.remove-item').forEach(button => {
                 button.addEventListener('click', function() {
                     const index = parseInt(this.getAttribute('data-index'));
                     currentCart.splice(index, 1);
                     updateCartCount();
                     displayCart(); // Re-render
                 });
             });
        }

        // --- Order Placement Logic (Save to Firebase) ---
        function placeOrder() {
            if (!currentUser) {
                alert("You need to be logged in to place an order.");
                loginModal.style.display = "flex";
                return;
            }

            if (currentCart.length === 0) {
                alert("Your cart is empty!");
                return;
            }

            const checkoutBtn = document.getElementById('checkoutBtn');
            checkoutBtn.disabled = true;
            checkoutBtn.textContent = "Placing Order...";

            // Get user data from Firebase using the current user's UID
            const userRef = firebase.database().ref('users/' + currentUser.uid);
            userRef.once('value')
                .then((snapshot) => {
                    const userData = snapshot.val();
                    if (!userData) {
                         throw new Error("User data not found in database.");
                    }

                    let totalValue = 0;
                    currentCart.forEach(item => {
                        totalValue += item.price * item.quantity;
                    });
                    totalValue = parseFloat(totalValue.toFixed(2));

                    const orderData = {
                        userId: currentUser.uid, // Use Firebase UID
                        userMobile: userData.mobile, // Get mobile from user data
                        userLocation: userData.location, // Get location from user data
                        items: currentCart,
                        totalValue: totalValue,
                        orderStatus: "Pending",
                        timestamp: firebase.database.ServerValue.TIMESTAMP
                    };

                    // Save order to Firebase
                    const newOrderRef = firebase.database().ref('orders').push();
                    return newOrderRef.set(orderData); // Return promise for chaining
                })
                .then(() => {
                    console.log("Order placed successfully.");
                    alert(`Order placed successfully!\nTotal: ₹${currentCart.reduce((sum, item) => sum + item.price * item.quantity, 0).toFixed(2)}\nStatus: Pending`);
                    // Clear cart in memory
                    currentCart = [];
                    updateCartCount();
                    cartModal.style.display = "none";
                })
                .catch((error) => {
                    console.error("Error placing order:", error);
                    alert("Failed to place order. Please try again. Error: " + error.message);
                })
                .finally(() => {
                    // Reset button state
                    checkoutBtn.disabled = false;
                    checkoutBtn.textContent = "Proceed to Checkout";
                });
        }

        document.getElementById('checkoutBtn').addEventListener('click', function() {
             placeOrder();
        });

        // --- Initialize Data Loading ---
        window.addEventListener('load', function() {
            console.log("Window loaded, initializing data...");
            loadMenuItemsFromFirebase();
            // Cart count is updated on load and after login
        });

    </script>
    <!-- ==================== END FIREBASE INTEGRATION ==================== -->

</body>
    </html>
